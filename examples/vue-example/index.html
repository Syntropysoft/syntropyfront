<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SyntropyFront Vue Demo</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        background: #f5f5f5;
        color: #333;
      }

      .app {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .app-header {
        text-align: center;
        margin-bottom: 40px;
        padding: 40px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px;
      }

      .app-header h1 {
        margin: 0 0 10px 0;
        font-size: 2.5rem;
      }

      .app-header p {
        margin: 0 0 20px 0;
        font-size: 1.2rem;
        opacity: 0.9;
      }

      .status {
        background: rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
      }

      .stats {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
        justify-content: center;
      }

      .stats span {
        background: rgba(255, 255, 255, 0.2);
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.9rem;
      }

      .config-selector {
        margin-bottom: 30px;
        text-align: center;
      }

      .config-buttons {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-top: 15px;
      }

      .config-buttons button {
        padding: 10px 20px;
        border: 2px solid #ddd;
        background: white;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .config-buttons button.active {
        border-color: #667eea;
        background: #667eea;
        color: white;
      }

      .actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
        margin-bottom: 40px;
      }

      .actions button {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        background: #667eea;
        color: white;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.3s;
      }

      .actions button:hover {
        background: #5a6fd8;
        transform: translateY(-2px);
      }

      .actions button.error-btn {
        background: #e74c3c;
      }

      .actions button.error-btn:hover {
        background: #c0392b;
      }

      .info {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 12px;
        line-height: 1.6;
      }

      .info h3 {
        color: #333;
        margin-top: 30px;
        margin-bottom: 15px;
      }

      .info ul, .info ol {
        margin-bottom: 20px;
        padding-left: 20px;
      }

      .info li {
        margin-bottom: 8px;
      }

      .info pre {
        background: #2d3748;
        color: #e2e8f0;
        padding: 20px;
        border-radius: 8px;
        overflow-x: auto;
        margin: 20px 0;
      }

      .info code {
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 0.9rem;
      }

      @media (max-width: 768px) {
        .app-header h1 {
          font-size: 2rem;
        }
        
        .actions {
          flex-direction: column;
        }
        
        .config-buttons {
          flex-direction: column;
        }
        
        .stats {
          flex-direction: column;
          align-items: center;
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div class="app">
        <header class="app-header">
          <h1>üöÄ SyntropyFront Vue Demo</h1>
          <p>Observability library with automatic capture</p>
          <div class="status">
            <span v-if="!syntropyFrontLoaded">‚è≥ Loading SyntropyFront...</span>
            <span v-else>‚úÖ SyntropyFront loaded and working</span>
            <div v-if="stats" class="stats">
              <span>üìä Breadcrumbs: {{ stats.breadcrumbs }}</span>
              <span>üö® Errors: {{ stats.errors }}</span>
              <span>üì§ Mode: {{ configMode }}</span>
              <span v-if="stats.hasErrorCallback">üéØ Custom handler: ‚úÖ</span>
              <span v-if="stats.hasFetchConfig">üåê Endpoint: {{ stats.endpoint }}</span>
            </div>
          </div>
        </header>

        <main class="app-main">
          <div class="config-selector">
            <h3>üîß Error Handling Configuration:</h3>
            <div class="config-buttons">
              <button 
                @click="setConfigMode('console')" 
                :class="{ active: configMode === 'console' }"
              >
                Console Only
              </button>
              <button 
                @click="setConfigMode('fetch')" 
                :class="{ active: configMode === 'fetch' }"
              >
                Automatic Fetch
              </button>
              <button 
                @click="setConfigMode('callback')" 
                :class="{ active: configMode === 'callback' }"
              >
                Custom Handler
              </button>
            </div>
          </div>

          <div class="actions">
            <button @click="handleClick">Click me! ({{ clickCount }})</button>
            <button @click="handleFetch">Test HTTP Request</button>
            <button @click="handleManualBreadcrumb">Add Manual Breadcrumb</button>
            <button @click="handleManualError">Send Manual Error</button>
            <button @click="handleError" class="error-btn">Simulate Error</button>
          </div>

          <div class="info">
            <h3>What does SyntropyFront do automatically?</h3>
            <ul>
              <li>üéØ Captures all clicks</li>
              <li>üö® Detects errors automatically</li>
              <li>üåê Intercepts HTTP calls</li>
              <li>üìù Records console logs</li>
              <li>üíæ Keeps the last N events (configurable)</li>
              <li>üì§ Handles errors with priority system</li>
            </ul>

            <h3>Error Handling Priority:</h3>
            <ol>
              <li><strong>Custom Handler</strong> - You decide what to do with errors</li>
              <li><strong>Automatic Fetch</strong> - Posts to your endpoint</li>
              <li><strong>Console Only</strong> - Default fallback</li>
            </ol>

            <h3>How to configure error handling?</h3>
            <pre><code>import syntropyFront from '@syntropysoft/syntropyfront';

// Option 1: Console only (default)
syntropyFront.configure({
  maxEvents: 50
});

// Option 2: Automatic fetch
syntropyFront.configure({
  maxEvents: 50,
  fetch: {
    url: 'https://your-api.com/errors',
    options: {
      headers: { 'Content-Type': 'application/json' },
      mode: 'cors'
    }
  }
});

// Option 3: Custom handler (maximum flexibility)
syntropyFront.configure({
  maxEvents: 50,
  onError: (errorPayload) => {
    // You can do anything:
    // - Send to your API
    // - Save to localStorage
    // - Send to multiple services
    // - Upload to cloud
    // - Whatever you want!
    console.log('Error:', errorPayload);
    
    // Example: send to multiple places
    fetch('https://api1.com/errors', {
      method: 'POST',
      body: JSON.stringify(errorPayload)
    });
    
    localStorage.setItem('lastError', JSON.stringify(errorPayload));
  }
});

// Ready! Auto-initializes</code></pre>

            <h3>‚ö†Ô∏è Note about CORS:</h3>
            <p>
              To work with your API, you need to configure CORS on your server to allow requests from your domain.
              The example endpoints (JSONPlaceholder) already have CORS configured.
            </p>

            <h3>What gets captured?</h3>
            <pre><code>{
  "type": "uncaught_exception",
  "error": {
    "message": "Error message",
    "source": "file.js",
    "lineno": 42,
    "colno": 15,
    "stack": "Error stack trace..."
  },
  "breadcrumbs": [
    {
      "category": "user",
      "message": "click",
      "data": { "element": "BUTTON", "x": 100, "y": 200 },
      "timestamp": "2024-01-01T12:00:00.000Z"
    }
    // ... last N events
  ],
  "timestamp": "2024-01-01T12:00:00.000Z"
}</code></pre>

            <p><strong>You only need 1 line of basic code!</strong></p>
            <p><strong>Choose your error handling strategy: console, fetch, or custom handler</strong></p>
            <pre><code>import syntropyFront from '@syntropysoft/syntropyfront';
// Ready! Auto-initializes</code></pre>
          </div>
        </main>
      </div>
    </div>

    <script>
      const { createApp } = Vue;

      // Mock SyntropyFront for demo purposes
      const mockSyntropyFront = {
        breadcrumbs: 0,
        errors: 0,
        isActive: true,
        maxEvents: 20,
        hasFetchConfig: false,
        hasErrorCallback: false,
        endpoint: 'console',
        
        configure(config) {
          console.log('üéØ SyntropyFront configured:', config);
          this.maxEvents = config.maxEvents || 20;
          this.hasFetchConfig = !!config.fetch;
          this.hasErrorCallback = !!config.onError;
          this.endpoint = config.fetch?.url || 'console';
        },
        
        addBreadcrumb(category, message) {
          this.breadcrumbs++;
          console.log('üìù Breadcrumb added:', { category, message });
        },
        
        sendError(error) {
          this.errors++;
          console.log('üö® Error sent:', error.message);
        },
        
        getStats() {
          return {
            breadcrumbs: this.breadcrumbs,
            errors: this.errors,
            isActive: this.isActive,
            maxEvents: this.maxEvents,
            hasFetchConfig: this.hasFetchConfig,
            hasErrorCallback: this.hasErrorCallback,
            endpoint: this.endpoint
          };
        }
      };

      createApp({
        data() {
          return {
            clickCount: 0,
            stats: null,
            configMode: 'console',
            syntropyFrontLoaded: false,
            syntropyFront: mockSyntropyFront
          }
        },
        methods: {
          setConfigMode(mode) {
            this.configMode = mode;
          },
          handleClick() {
            this.clickCount++;
            console.log('Button clicked!');
          },
          handleError() {
            throw new Error('Simulated error to test SyntropyFront');
          },
          async handleFetch() {
            try {
              const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
              const data = await response.json();
              console.log('Fetch response:', data);
            } catch (error) {
              console.error('Fetch error:', error);
            }
          },
          handleManualBreadcrumb() {
            this.syntropyFront.addBreadcrumb('user', 'Manual breadcrumb added');
            console.log('Manual breadcrumb added');
          },
          handleManualError() {
            this.syntropyFront.sendError(new Error('Manual error sent'));
            console.log('Manual error sent');
          }
        },
        watch: {
          configMode: {
            handler(newMode) {
              let config = { maxEvents: 20 };

              if (newMode === 'fetch') {
                config.fetch = {
                  url: 'https://jsonplaceholder.typicode.com/posts',
                  options: {
                    headers: {
                      'Content-Type': 'application/json',
                    },
                    mode: 'cors',
                  },
                };
              } else if (newMode === 'callback') {
                config.onError = (errorPayload) => {
                  console.log('üéØ Custom error handler called:', errorPayload);
                  
                  // Example: send to multiple places
                  fetch('https://jsonplaceholder.typicode.com/posts', {
                    method: 'POST',
                    body: JSON.stringify(errorPayload),
                    headers: { 'Content-Type': 'application/json' }
                  }).catch(err => console.log('Fetch failed:', err));
                  
                  // Also save locally
                  localStorage.setItem('lastError', JSON.stringify(errorPayload));
                  
                  console.log('‚úÖ Error handled by custom callback');
                };
              }

              // Configure SyntropyFront
              this.syntropyFront.configure(config);
            },
            immediate: true
          }
        },
        mounted() {
          // Simulate SyntropyFront loading
          setTimeout(() => {
            this.syntropyFrontLoaded = true;
            console.log('‚úÖ SyntropyFront loaded and working');
          }, 1000);

          // Update stats every second
          setInterval(() => {
            this.stats = this.syntropyFront.getStats();
          }, 1000);
        }
      }).mount('#app');
    </script>
  </body>
</html> 